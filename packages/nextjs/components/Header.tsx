import React, { useCallback, useRef, useState } from "react";
import Image from "next/image";
import Link from "next/link";
import { useRouter } from "next/router";
import { Bars3Icon, BugAntIcon } from "@heroicons/react/24/outline";
import { FaucetButton, RainbowKitCustomConnectButton } from "~~/components/scaffold-eth";
import { useOutsideClick } from "~~/hooks/scaffold-eth";
import { CreateCampaign } from "./CreateCampaign";
import {User} from '@web3uikit/icons'
import {Home} from '@web3uikit/icons'
import { useAccount } from "wagmi";

type HeaderMenuLink = {
  label: string;
  href: string;
  icon?: React.ReactNode;
};

export const menuLinks: HeaderMenuLink[] = [
  {
    label: "Home",
    href: "/",
    icon: <Home className="h-4 w-4" />,
  },
  {
    label: "My profil",
    href: "/profil",
    icon: <User className="h-4 w-4" />,
  }
];

export const HeaderMenuLinks = () => {
  const router = useRouter();
  const accountState = useAccount();

  return (
    <>
      {menuLinks.map(({ label, href, icon }) => {
        const isActive = router.pathname === href;
        if (label != 'My profil') {
          return (
            <li key={href}>
              <Link
                href={href}
                passHref
                className={`${
                  isActive ? "bg-secondary shadow-md" : ""
                } hover:bg-secondary hover:shadow-md focus:!bg-secondary active:!text-neutral py-1.5 px-3 text-sm rounded-full gap-2 grid grid-flow-col`}
              >
                {icon}
                <span>{label}</span>
              </Link>
            </li>
          );
        } 
        else if (accountState.isConnected) {
          return (
            <li key={href}>
              <Link
                href={href}
                passHref
                className={`${
                  isActive ? "bg-secondary shadow-md" : ""
                } hover:bg-secondary hover:shadow-md focus:!bg-secondary active:!text-neutral py-1.5 px-3 text-sm rounded-full gap-2 grid grid-flow-col`}
              >
                {icon}
                <span>{label}</span>
              </Link>
            </li>
          );
        }
      })}
    </>
  );
};

/**
 * Site header
 */
export const Header = () => {
  const [isDrawerOpen, setIsDrawerOpen] = useState(false);
  const burgerMenuRef = useRef<HTMLDivElement>(null);
  useOutsideClick(
    burgerMenuRef,
    useCallback(() => setIsDrawerOpen(false), []),
  );

  return (
    <div className="sticky lg:static top-0 navbar bg-base-100 min-h-0 flex-shrink-0 justify-between z-20 shadow-md shadow-secondary px-0 sm:px-2">
      <div className="navbar-start w-auto lg:w-1/2">
        <div className="lg:hidden dropdown" ref={burgerMenuRef}>
          <label
            tabIndex={0}
            className={`ml-1 btn btn-ghost ${isDrawerOpen ? "hover:bg-secondary" : "hover:bg-transparent"}`}
            onClick={() => {
              setIsDrawerOpen(prevIsOpenState => !prevIsOpenState);
            }}
          >
            <Bars3Icon className="h-1/2" />
          </label>
          {isDrawerOpen && (
            <ul
              tabIndex={0}
              className="menu menu-compact dropdown-content mt-3 p-2 shadow bg-base-100 rounded-box w-52"
              onClick={() => {
                setIsDrawerOpen(false);
              }}
            >
              <HeaderMenuLinks />
            </ul>
          )}
        </div>
        <Link href="/" passHref className="hidden lg:flex items-center gap-2 ml-4 mr-6 shrink-0">
          <div className="flex relative w-16 h-10">
            {/* <Image alt="SE2 logo" className="cursor-pointer" fill src="/logo.svg" /> */}
            <svg width="800" height="40" viewBox="0 10 350 180" class="looka-1j8o68f"><defs id="SvgjsDefs1120"></defs><g id="SvgjsG1121" featurekey="symbolFeature-0" transform="matrix(1.5556474924087524,0,0,1.5556474924087524,97.21796467432472,-13.26250237055056)" fill="#222831"><path xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" d="M5.5107422,32.71875c0.4741211-1.3896484,1.1865234-2.2871094,2.1352539-2.6943359  c1.1523438-0.4736328,2.5766602-0.2705078,4.2714844,0.6103516l0.1015625,0.0507813l1.0170898,0.7626953l0.1015625,0.1015625  c3.0512695,2.2363281,4.8134766,3.5410156,5.2880859,3.9140625c1.6953125,1.2539063,3.6274414,2.7441406,5.796875,4.4726563  c1.9321289,1.5244141,3.847168,3.0830078,5.7456055,4.6757813C30.171875,44.78125,30.3076172,45.0527344,30.375,45.4257813  l0.0512695,13.875c8.4741211,4.8466797,12.8808594,8.8105469,13.2202148,11.8935547l0.0507813,0.1533203V89.390625h1.9833984  c0.2709961,0,0.5083008,0.1015625,0.7114258,0.3056641c0.2036133,0.203125,0.3051758,0.4404297,0.3051758,0.7109375  c0,0.7119141-0.3388672,1.0673828-1.0166016,1.0673828H24.1206055c-0.7119141,0-1.0673828-0.3554688-1.0673828-1.0673828  c0-0.2705078,0.1010742-0.5078125,0.3046875-0.7109375c0.2036133-0.2041016,0.4580078-0.3056641,0.7626953-0.3056641h1.7797852  V78.6660156c-7.1523438-5.3876953-14.0166016-12.0625-20.5932617-20.0253906  c-0.2036133-0.1699219-0.3046875-0.3896484-0.3046875-0.6611328l0.4570313-25.0068359L5.5107422,32.71875z M8.3579102,31.9560547  c-0.3046875,0.1699219-0.5932617,0.5761719-0.8642578,1.2207031l-0.355957,24.4472656  c6.4067383,7.8271484,13.1865234,14.3837891,20.3388672,19.6699219c0.2714844,0.203125,0.4072266,0.4912109,0.4072266,0.8642578  V89.390625H41.612793V71.3984375c-0.3730469-2.4736328-4.59375-6.0146484-12.6616211-10.6230469h-0.050293v-0.0507813  c-0.7460938-0.4404297-1.5087891-0.8300781-2.2885742-1.1689453l-14.4912109-7.8789063h-0.0512695l-0.6103516-0.3046875  c-0.3046875,0.4404297-0.559082,1.1689453-0.7626953,2.1855469c0.3056641,1.2880859,2.1357422,3.5078125,5.4921875,6.6591797  c2.847168,2.6425781,6.4233398,5.7939453,10.7285156,9.453125c0.2373047,0.1689453,0.3730469,0.3896484,0.4067383,0.6611328  c0,0.2705078-0.0844727,0.5078125-0.2543945,0.7109375c-0.1694336,0.2373047-0.4067383,0.3730469-0.7114258,0.4072266  c-0.2373047,0-0.4580078-0.0849609-0.6616211-0.2548828c-3.8642578-3.21875-7.4916992-6.4033203-10.8808594-9.5546875  c-3.8984375-3.5917969-5.9663086-6.2177734-6.2036133-7.8789063c-0.0678711-0.1015625-0.0678711-0.2197266,0-0.3554688  c0.4067383-2.7783203,1.3896484-4.1679688,2.9492188-4.1679688V32.8710938l-0.6611328-0.40625  C9.8154297,31.9228516,8.9682617,31.7529297,8.3579102,31.9560547z M13.5444336,34.2949219v15.8574219l0.1020508,0.1015625  l3.203125,1.6269531V36.7851563L13.5444336,34.2949219z M22.5449219,54.9296875v-13.671875l-3.7124023-2.9482422v14.5878906  L22.5449219,54.9296875z M24.6293945,56.0488281l3.7114258,2.0322266l-0.050293-12.1474609l-3.6611328-3.1005859V56.0488281z   M50.0024414,12.1337891c2.949707-2.40625,6.1352539-3.6083984,9.559082-3.6083984  c4.4072266,0,8.1865234,1.6259766,11.3388672,4.8789063c3.0849609,3.2197266,4.6269531,7.0986328,4.6269531,11.6396484v0.0507813  C75.3925781,30.3125,72.8164063,35.53125,67.7998047,40.7490234c-4.3398438,4.5068359-10.0175781,8.6074219-17.034668,12.3007813  l-0.7626953,0.40625l-0.7119141-0.40625c-7.0849609-3.6933594-12.8305664-7.8271484-17.237793-12.4013672  c-5.050293-5.2871094-7.5756836-10.4707031-7.5756836-15.5537109c0-4.5410156,1.559082-8.4375,4.6777344-11.6904297  s6.8813477-4.8789063,11.2880859-4.8789063C43.8325195,8.5253906,47.019043,9.7275391,50.0024414,12.1337891z   M87.0195313,31.4990234l0.1015625-0.0507813l1.0175781-0.7626953l0.1005859-0.0507813  c1.6611328-0.8808594,3.0849609-1.0839844,4.2714844-0.6103516c0.9150391,0.4072266,1.6103516,1.3046875,2.0849609,2.6943359  l0.3554688,25.2607422c0.1015625,0.2714844,0.0351563,0.4912109-0.203125,0.6611328  c-6.5087891,7.9287109-13.3388672,14.6044922-20.4921875,20.0253906V89.390625h1.7294922  c0.3046875,0,0.5595703,0.1015625,0.7626953,0.3056641c0.203125,0.203125,0.3046875,0.4404297,0.3046875,0.7109375  c0,0.3388672-0.1015625,0.6103516-0.3046875,0.8134766c-0.203125,0.1689453-0.4580078,0.2539063-0.7626953,0.2539063H54.4775391  c-0.6787109,0-1.0175781-0.3554688-1.0175781-1.0673828c0-0.6777344,0.3388672-1.0166016,1.0175781-1.0166016h2.0332031V71.1943359  c0.3398438-3.0830078,4.7460938-7.046875,13.2207031-11.8935547l0.1015625-13.875  c0-0.3388672,0.1181641-0.6103516,0.3554688-0.8134766c1.8642578-1.5927734,3.7626953-3.1513672,5.6953125-4.6757813  c2.203125-1.7285156,4.1357422-3.21875,5.796875-4.4726563l0.0498047-0.0517578  C83.2226563,34.2265625,84.9853516,32.921875,87.0195313,31.4990234z M83.3076172,36.7851563v15.0957031l3.3056641-1.7285156  V34.2949219L83.3076172,36.7851563z M88.6464844,32.8710938v16.3662109c1.4912109,0,2.4414063,1.3896484,2.8476563,4.1679688  c0.0673828,0.1357422,0.0673828,0.2539063,0,0.3554688c-0.2373047,1.6611328-2.3222656,4.2871094-6.2539063,7.8789063  c-3.1533203,3.015625-6.7460938,6.2011719-10.7802734,9.5546875c-0.2041016,0.1699219-0.4404297,0.2548828-0.7119141,0.2548828  c-0.3046875-0.0341797-0.5429688-0.1699219-0.7119141-0.4072266c-0.1689453-0.203125-0.2373047-0.4404297-0.203125-0.7109375  c0-0.2714844,0.1181641-0.4921875,0.3564453-0.6611328c4.4736328-3.7617188,8.0498047-6.9121094,10.7285156-9.453125  c3.3554688-3.1513672,5.1855469-5.3710938,5.4912109-6.6591797c-0.203125-1.1181641-0.4580078-1.8466797-0.7626953-2.1855469  l-0.5595703,0.3046875l-0.0507813,0.0517578l-0.7119141,0.2539063l-13.7285156,7.5224609  c-0.8476563,0.3720703-1.6445313,0.7792969-2.390625,1.2197266l-0.0507813,0.0507813  c-8.1005859,4.6425781-12.3046875,8.1826172-12.609375,10.6230469V89.390625h13.6777344V78.1582031  c0-0.3730469,0.1357422-0.6611328,0.4072266-0.8642578c7.1181641-5.2177734,13.8974609-11.7753906,20.3388672-19.6699219  l-0.3056641-24.4472656c-0.2373047-0.6445313-0.5419922-1.0507813-0.9150391-1.2207031  c-0.6103516-0.203125-1.4580078-0.0332031-2.5419922,0.5087891L88.6464844,32.8710938z M71.8164063,45.9335938L71.765625,58.0810547  l3.7617188-2.0322266V42.8330078L71.8164063,45.9335938z M77.6132813,54.9296875l3.6601563-2.0322266V38.3095703  l-3.6601563,2.9482422V54.9296875z"></path></g><g id="SvgjsG1122" featurekey="nameFeature-0" transform="matrix(1.701209306716919,0,0,1.701209306716919,-4.695336711416465,128.17720237497048)" fill="#222831"><path d="M8.04 25.04 l0 11.96 c0 1.92 -0.68 3.12 -2.64 3.12 s-2.64 -1.2 -2.64 -3.12 l0 -21.8 c0 -1.52 0.84 -2.72 2.2 -2.72 l12.2 0 c1.36 0 2.44 0.72 2.44 2.28 s-1.08 2.28 -2.44 2.28 l-9.12 0 l0 3.44 l8.72 0 c1.36 0 2.44 0.72 2.44 2.28 s-1.08 2.28 -2.44 2.28 l-8.72 0 z M22.882 27.560000000000002 l1.16 -12.4 c0.12 -1.36 0.76 -2.8 2.4 -2.8 c1.76 0 2.4 1.36 2.4 2.32 c0 5.28 -1.24 10.48 -1.24 15.76 c0 3.12 2.24 5.24 5.32 5.24 s5.32 -2.12 5.32 -5.24 c0 -5.28 -1.24 -10.48 -1.24 -15.76 c0 -0.96 0.64 -2.32 2.4 -2.32 c1.64 0 2.28 1.44 2.4 2.8 l1.16 12.4 c0.08 1.04 0.08 2.24 0.08 3.36 c0 5.56 -4.4 9.32 -10.12 9.32 s-10.12 -3.76 -10.12 -9.32 c0 -1.12 0 -2.32 0.08 -3.36 z M67.764 15.120000000000001 l0 22.24 c0 1.56 -0.8 2.76 -2.52 2.76 s-2.52 -1.2 -2.52 -2.76 l0 -12.68 c-3.28 -0.36 -6.64 -2.64 -9.28 -5.72 l0 18.4 c0 1.56 -0.8 2.76 -2.52 2.76 s-2.52 -1.2 -2.52 -2.76 l0 -22.24 c0.08 -1.56 1.04 -2.76 3.24 -2.76 c3.92 0 4.36 5.88 11.08 7.76 l0 -5 c0 -1.56 0.8 -2.76 2.52 -2.76 s2.52 1.2 2.52 2.76 z M73.686 37.04 l0 -21.44 c0 -2 0.96 -3.12 3.48 -3.12 c14.92 0 19.12 9.92 19.12 16.04 c0 6.04 -3.88 11.48 -10.68 11.48 l-8.36 0 c-2.6 0 -3.56 -0.64 -3.56 -2.96 z M78.726 17.28 l0 17.92 l3.88 0 c5.96 0 8 -2 8 -6.32 c0 -6.48 -5.32 -11.6 -11.88 -11.6 z M106.00800000000001 25.16 l0 12.28 c0 1.48 -0.8 2.68 -2.52 2.68 s-2.52 -1.2 -2.52 -2.68 l0 -22.28 c0 -1.48 0.8 -2.68 2.52 -2.68 l8.56 0 c6.08 0 8.4 1.76 8.4 5.68 c0 2.72 -1.52 4.88 -3.64 6.28 c3.44 3.12 5.28 8.24 5.28 12.08 c0 1.84 -0.36 3.6 -2.36 3.6 c-2.2 0 -2.64 -1.48 -2.68 -3.36 c-0.12 -6.04 -3.4 -11.6 -11.04 -11.6 z M106.00800000000001 17.04 l0 3.8 c2.2 0 3.24 0.24 4.24 0.44 l2.44 0.64 c1.08 0 2.72 -1.8 2.72 -3 c0 -1.28 -1 -1.88 -2.72 -1.88 l-6.68 0 z M132.69000000000003 28.32 l-1.04 0 c-1.08 2.92 -1.68 6.76 -1.96 9.44 c-0.16 1.48 -1 2.36 -2.44 2.36 c-2.16 0 -2.6 -1.28 -2.6 -3.2 c0 -1.24 0.68 -8.44 5.92 -18.32 c2.28 -4.32 3.56 -6.36 6.36 -6.36 c2.32 0 3.68 2.04 5.96 6.36 c5.24 9.88 6.32 17.08 6.32 18.32 c0 2.08 -1 3.2 -2.4 3.2 c-2 0 -2.48 -1.16 -2.88 -3.32 c-1.04 -5.76 -6.76 -8.48 -11.24 -8.48 z M132.85000000000002 24.32 l0.52 0 c1.96 0 5.4 0.56 8.04 2.72 l0.08 -0.08 c-1.2 -3.44 -2.72 -6.8 -4.68 -9.92 c-1.6 2.4 -2.92 4.8 -3.96 7.28 z M159.092 15.079999999999998 l0 22.32 c0 1.52 -0.8 2.72 -2.52 2.72 s-2.52 -1.2 -2.52 -2.72 l0 -22.32 c0 -1.52 0.8 -2.72 2.52 -2.72 s2.52 1.2 2.52 2.72 z M180.81400000000002 17.28 l-9.24 0 c-1.24 0 -1.92 0.56 -1.92 1.6 c0 3.64 16.12 0.28 16.12 11.44 c0 5.04 -3.8 9.68 -10.64 9.68 l-8.6 0 c-1.44 0 -2.6 -0.76 -2.6 -2.4 s1.16 -2.4 2.6 -2.4 l6.56 0 c5.2 0 7.4 -1.28 7.4 -4.68 c0 -7.32 -16.12 -1.48 -16.12 -11.56 c0 -4.16 3.16 -6.48 8.16 -6.48 l8.28 0 c1.44 0 2.6 0.76 2.6 2.4 s-1.16 2.4 -2.6 2.4 z M196.056 17.04 l0 3.44 l9.6 0 c1.36 0 2.44 0.72 2.44 2.28 s-1.08 2.28 -2.44 2.28 l-9.6 0 l0 10.4 l10 0 c1.36 0 2.44 0.72 2.44 2.28 s-1.08 2.28 -2.44 2.28 l-11.8 0 c-2.64 0 -3.48 -1.36 -3.48 -3.44 l0 -21.36 c0 -1.52 0.84 -2.72 2.2 -2.72 l13.08 0 c1.36 0 2.44 0.72 2.44 2.28 s-1.08 2.28 -2.44 2.28 l-10 0 z"></path></g></svg>
          </div>
        </Link>
        <ul className="hidden lg:flex lg:flex-nowrap menu menu-horizontal px-1 gap-2">
          <HeaderMenuLinks />
        </ul>
      </div>
      <div className="navbar-end flex-grow mr-4">
        <CreateCampaign />
        <RainbowKitCustomConnectButton />
        <FaucetButton />
      </div>
    </div>
  );
};
